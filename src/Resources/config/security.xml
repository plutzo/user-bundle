<?xml version="1.0" encoding="utf-8"?>
<container xmlns="http://symfony.com/schema/dic/services" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
    <parameters>
        <parameter key="marlinc.user.class.user">Marlinc\UserBundle\Entity\User</parameter>
        <parameter key="marlinc.user.class.group">Marlinc\UserBundle\Entity\Group</parameter>
        <parameter key="marlinc.user.admin.login">marlinc_user_admin_security_login</parameter>
        <parameter key="marlinc.user.admin.redirect">sonata_admin_dashboard</parameter>
        <parameter key="marlinc.user.cas.serverurl">null</parameter>
        <parameter key="marlinc.user.cas.ticketname">null</parameter>
        <parameter key="marlinc.user.cas.servicename">null</parameter>
        <parameter key="marlinc.user.cas.username">null</parameter>
        <parameter key="marlinc.user.cas.xmlnamespace">null</parameter>
    </parameters>
    <services>
        <defaults public="false" />
        <service id="Marlinc\UserBundle\Manager\UserManager">
            <argument type="service" id="Marlinc\UserBundle\Util\PasswordUpdaterInterface"/>
            <argument type="service" id="Marlinc\UserBundle\Util\CanonicalizerInterface"/>
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <argument>%marlinc.user.class.user%</argument>
        </service>
        <service id="Marlinc\UserBundle\Manager\GroupManager">
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <argument>%marlinc.user.class.group%</argument>
        </service>
        <service id="Marlinc\UserBundle\Manager\Marlinc1UserLoader">
            <argument type="service" id="doctrine.connections" />
        </service>
        <service id="marlinc.user.authenticator.cas" class="Marlinc\UserBundle\Security\Authenticator\CasAuthenticator">
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="Marlinc\UserBundle\Manager\UserManager" />
            <argument>%marlinc.user.cas.serverurl%</argument>
            <argument>%marlinc.user.cas.xmlnamespace%</argument>
            <argument>%marlinc.user.cas.ticketname%</argument>
            <argument>%marlinc.user.cas.servicename%</argument>
            <argument>%marlinc.user.cas.username%</argument>
        </service>
        <service id="marlinc.user.authenticator.legacy" class="Marlinc\UserBundle\Security\Authenticator\Marlinc1Authenticator">
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="lexik_jwt_authentication.extractor.authorization_header_extractor" />
            <argument type="service" id="security.token_storage" />
            <argument type="service" id="Marlinc\UserBundle\Manager\Marlinc1UserLoader" />
        </service>
        <service id="marlinc.user.provider.legacy" class="Marlinc\UserBundle\Security\UserProvider\Marlinc1UserProvider">
            <argument type="service" id="Marlinc\UserBundle\Manager\UserManager" />
            <argument type="service" id="Marlinc\UserBundle\Manager\Marlinc1UserLoader"/>
        </service>
        <service id="marlinc.user.provider.cas" class="Marlinc\UserBundle\Security\UserProvider\CasUserProvider">
            <argument type="service" id="Marlinc\UserBundle\Manager\UserManager" />
        </service>
        <service id="Marlinc\UserBundle\Security\Authenticator\LoginFormAuthenticator" abstract="true">
            <argument type="service" id="router"/>
            <argument type="service" id="security.password_encoder"/>
            <argument type="service" id="security.csrf.token_manager"/>
        </service>
        <service id="marlinc.user.formauth.admin" parent="Marlinc\UserBundle\Security\Authenticator\LoginFormAuthenticator" class="Marlinc\UserBundle\Security\Authenticator\LoginFormAuthenticator" public="false">
            <call method="setLoginRoute">
                <argument>%marlinc.user.admin.login%</argument>
            </call>
            <call method="setRedirectRoute">
                <argument>%marlinc.user.admin.redirect%</argument>
            </call>
        </service>
        <service id="Marlinc\UserBundle\Security\RolesBuilder\EditableRolesBuilder">
            <argument type="service" id="security.token_storage"/>
            <argument type="service" id="security.authorization_checker"/>
            <argument type="service" id="sonata.admin.pool"/>
            <argument>%security.role_hierarchy.roles%</argument>
            <call method="setTranslator">
                <argument type="service" id="translator"/>
            </call>
        </service>
        <service id="Marlinc\UserBundle\Security\RolesBuilder\MatrixRolesBuilder">
            <argument type="service" id="security.token_storage"/>
            <argument type="service" id="Marlinc\UserBundle\Security\RolesBuilder\AdminRolesBuilder"/>
            <argument type="service" id="Marlinc\UserBundle\Security\RolesBuilder\SecurityRolesBuilder"/>
        </service>
        <service id="Marlinc\UserBundle\Security\RolesBuilder\AdminRolesBuilder">
            <argument type="service" id="security.authorization_checker"/>
            <argument type="service" id="sonata.admin.pool"/>
            <argument type="service" id="translator"/>
        </service>
        <service id="Marlinc\UserBundle\Security\RolesBuilder\SecurityRolesBuilder">
            <argument type="service" id="security.authorization_checker"/>
            <argument type="service" id="sonata.admin.pool"/>
            <argument type="service" id="translator"/>
            <argument>%security.role_hierarchy.roles%</argument>
        </service>
        <service id="Marlinc\UserBundle\Security\UserChecker" />
    </services>
</container>
